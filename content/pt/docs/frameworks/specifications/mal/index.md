---
title: Especifica√ß√µes MAL - Matrix Arbiter Layer
description: Schemas YAML can√¥nicos para eventos de arbitragem e registros de decis√£o do Matrix Arbiter Layer
keywords:
  - MAL
  - Matrix Arbiter Layer
  - arbitragem determin√≠stica
  - resolu√ß√£o de conflitos
  - conflitos horizontais
  - enriquecimento concorrente
  - conten√ß√£o de promo√ß√£o
  - Decision Records
  - schemas YAML
framework: MAL
icon: i-heroicons-scale
layout: docs
sidebar: true
toc: true
navigation: true
lang: pt
last_updated: 2025-10-31T00:00:00.000Z
order: 5
---

# Especifica√ß√µes MAL - Matrix Arbiter Layer

Esta se√ß√£o cont√©m as especifica√ß√µes can√¥nicas normativas para o **Matrix Arbiter Layer (MAL)**, definindo schemas YAML para eventos de arbitragem e registros de decis√£o determin√≠stica para resolu√ß√£o de conflitos de conhecimento.

## üìã Schemas Dispon√≠veis

### 1. MAL Arbitration Event Schema
**Arquivo:** `mal-arbitration-event-schema.yaml`  
**Vers√£o:** 1.0.0  
**Prop√≥sito:** Especifica√ß√£o para eventos de conflito que requerem arbitragem

<YamlViewer file-path="/content/pt/docs/frameworks/specifications/mal/mal-arbitration-event-schema.yaml" />

#### Tipos de Conflito
- **H1 (Horizontal Conflicts):** Conflitos entre UKIs de escopo equivalente
- **H2 (Concurrent Enrichment):** Tentativas simult√¢neas de enriquecimento
- **H3 (Promotion Contention):** Propostas concorrentes de promo√ß√£o

#### Componentes Principais
- **candidates:** Entidades conflitantes com metadados completos
- **user_moc_context:** Contexto hier√°rquico e autoridade do usu√°rio
- **conflict_details:** Detalhes espec√≠ficos por tipo de conflito
- **policy_ref:** Refer√™ncia a pol√≠tica de arbitragem MOC

### 2. MAL Decision Record Schema
**Arquivo:** `mal-decision-record-schema.yaml`  
**Vers√£o:** 1.0.0  
**Prop√≥sito:** Especifica√ß√£o para registros imut√°veis de decis√£o

<YamlViewer file-path="/content/pt/docs/frameworks/specifications/mal/mal-decision-record-schema.yaml" />

#### Resultados de Decis√£o
- **winner:** UKI √∫nica escolhida como autoritativa
- **coexist:** M√∫ltiplas UKIs v√°lidas via particionamento
- **reject_all:** Nenhuma UKI satisfaz requisitos
- **defer:** Requer interven√ß√£o humana ou escala√ß√£o

#### Elementos de Decis√£o
- **precedence_applied:** Regras P1-P6 aplicadas na decis√£o
- **epistemic_rationale:** Justificativa alinhada aos princ√≠pios MEP
- **actions:** A√ß√µes derivadas para execu√ß√£o
- **audit:** Informa√ß√µes completas de auditoria

## üéØ Uso das Especifica√ß√µes

### Para Implementadores

#### Evento de Arbitragem H1 (Conflito Horizontal)
```yaml
# Exemplo: Conflito entre regras de reten√ß√£o de dados
schema: "1.0"
event_id: mal-evt-20250826-001
event_type: H1
timestamp: 2025-08-26T14:30:25.123Z

candidates:
  - uki_ref: "uki:squad-x:rule:retencao-dados-30d"
    scope_ref: squad-x
    domain_ref: security
    type_ref: rule
    maturity_level: validated
    version: "1.2.0"
    evidence_refs: ["uki:org:policy:lgpd-compliance", "doc:logs-auditoria-2024"]
    conflict_metadata:
      conflicting_aspects: ["retention_period"]
      semantic_similarity: 0.85
      usage_frequency: 15

  - uki_ref: "uki:squad-x:rule:retencao-dados-7d"
    scope_ref: squad-x
    domain_ref: security
    type_ref: rule
    maturity_level: endorsed
    version: "2.0.0"
    evidence_refs: ["uki:org:policy:minimizacao-dados"]
    conflict_metadata:
      conflicting_aspects: ["retention_period"]
      semantic_similarity: 0.85
      usage_frequency: 3

user_moc_context:
  user_id: dev001
  scopes: ["squad-x", "tribe-alpha", "organization"]
  authority_level: squad_lead
  domain_access: ["technical", "security"]

operation: enrich

conflict_details:
  conflict_description: "Duas regras de seguran√ßa de escopo equivalente em conflito sobre per√≠odo de reten√ß√£o de dados"
  detection_method: semantic_analysis
  detection_timestamp: 2025-08-26T14:30:00.000Z
  severity: high
  
  h1_details:
    scope_equivalence: true
    semantic_overlap: 0.85
    contradictory_directives: ["retention_period: 30d vs 7d"]
    domain_intersection: ["security", "compliance"]

policy_ref: "moc:arbitration:security_priority"
```

#### Evento de Arbitragem H2 (Enriquecimento Concorrente)
```yaml
# Exemplo: Tentativas simult√¢neas de enriquecimento
schema: "1.0"
event_id: mal-evt-20250826-002
event_type: H2
timestamp: 2025-08-26T14:35:00.000Z

candidates:
  - uki_ref: "uki:squad-payments:pattern:auth-jwt-v1"
    scope_ref: squad-payments
    domain_ref: technical
    type_ref: pattern
    maturity_level: draft
    version: "1.0.0"

  - uki_ref: "uki:squad-payments:pattern:auth-jwt-v2"
    scope_ref: squad-payments
    domain_ref: technical
    type_ref: pattern
    maturity_level: experimental
    version: "1.0.0"

user_moc_context:
  user_id: dev002
  scopes: ["squad-payments"]
  authority_level: developer
  domain_access: ["technical"]

operation: enrich

conflict_details:
  conflict_description: "Tentativas simult√¢neas de enriquecimento em padr√µes de autentica√ß√£o JWT"
  detection_method: automated_workflow
  detection_timestamp: 2025-08-26T14:35:00.000Z
  severity: medium
  
  h2_details:
    concurrent_requests:
      - request_id: "req-001"
        timestamp: 2025-08-26T14:34:55.000Z
        user_id: dev001
        priority: high
      
      - request_id: "req-002"
        timestamp: 2025-08-26T14:35:02.000Z
        user_id: dev002
        priority: medium
    
    temporal_window_ms: 30000
    resource_contention: "oracle_enrichment_lock"
    first_request_advantage: false
```

#### Registro de Decis√£o Winner
```yaml
# Exemplo: Decis√£o com vencedor √∫nico
schema: "1.0"
decision_id: mal-dec-20250826-h1-001
event_ref: mal-evt-20250826-001
outcome: winner

winner: "uki:squad-x:rule:retencao-dados-30d"
losers: ["uki:squad-x:rule:retencao-dados-7d"]

precedence_applied:
  - rule_id: P3_maturity_level
    description: "Conhecimento validado tem preced√™ncia sobre experimental"
    weight: 0.8
    application_result:
      rule_outcome: "validated > endorsed"
      impact_on_decision: decisive
      numerical_score: 0.9
      compared_entities:
        - entity_ref: "uki:squad-x:rule:retencao-dados-30d"
          entity_value: "validated"
          score: 0.9
        - entity_ref: "uki:squad-x:rule:retencao-dados-7d"
          entity_value: "endorsed"
          score: 0.6

  - rule_id: P5_evidence_density
    description: "Maior densidade de evid√™ncias suporte"
    weight: 0.7
    application_result:
      rule_outcome: "2 evid√™ncias > 1 evid√™ncia"
      impact_on_decision: supportive
      numerical_score: 0.7

epistemic_rationale:
  summary: "Maturidade validada e evid√™ncia regulat√≥ria mais forte determinaram a escolha da regra de 30 dias"
  reasoning: "Enquanto ambas as UKIs operam em escopo equivalente de squad, a regra de reten√ß√£o de 30 dias demonstra maior maturidade epistemol√≥gica atrav√©s de seu status 'validated' e evid√™ncia regulat√≥ria mais robusta ligada aos requisitos de conformidade LGPD"
  
  references:
    moc_nodes: 
      - "hierarchies.scope.squad-x"
      - "hierarchies.domain.security"
      - "hierarchies.maturity.validated"
    mef_evidence: 
      - "uki:org:policy:lgpd-compliance"
    external_references: 
      - "doc:logs-auditoria-2024"
      - "reg:lgpd-art-6"
  
  mep_alignment:
    epistemic_humility: "Decis√£o baseada em crit√©rios organizacionais espec√≠ficos, reconhecendo limita√ß√µes contextuais"
    derived_authority: "Autoridade deriva do MOC organizacional e configura√ß√£o de pol√≠ticas"
    contextual_knowledge: "Decis√£o espec√≠fica para contexto squad-x no dom√≠nio seguran√ßa"
  
  uncertainty_assessment:
    confidence_level: 0.85
    risk_factors: ["Evid√™ncia regulat√≥ria pode mudar"]
    sensitivity_analysis: "Decis√£o robusta a pequenas varia√ß√µes nos crit√©rios"

actions:
  - "allow_enrich:uki:squad-x:rule:retencao-dados-30d"
  - "deprecate:uki:squad-x:rule:retencao-dados-7d"

audit:
  decided_at: 2025-08-26T14:30:26.789Z
  decided_by: mal-v1.0.0
  timeout_used_ms: 1250
  arbitration_timeout_ms: 2000
  
  processing_details:
    algorithm_version: "precedence-v1.0"
    policy_config_version: "moc-policy-v1.2"
    computational_complexity: medium
    
  quality_indicators:
    consistency_check: true
    precedent_alignment: 0.88
    stakeholder_impact_assessment: moderate
```

#### Registro de Decis√£o Coexist
```yaml
# Exemplo: Decis√£o de coexist√™ncia com particionamento
schema: "1.0"
decision_id: mal-dec-20250826-h1-002
event_ref: mal-evt-20250826-003
outcome: coexist

coexistence_arrangement:
  partition_strategy: scope_partition
  
  partition_rules:
    - uki_ref: "uki:squad-a:guideline:code-review"
      assigned_context:
        scope_restriction: "squad-a"
        domain_restriction: "technical"
      conditions: ["user.scope == 'squad-a'"]
      precedence_order: 1
    
    - uki_ref: "uki:squad-b:guideline:code-review"
      assigned_context:
        scope_restriction: "squad-b"
        domain_restriction: "technical"
      conditions: ["user.scope == 'squad-b'"]
      precedence_order: 2
  
  conflict_resolution_rules:
    - "Em caso de sobreposi√ß√£o cross-squad, escala√ß√£o autom√°tica para tribe-lead"

precedence_applied:
  - rule_id: P2_scope_specificity
    description: "Escopo mais espec√≠fico vence para orienta√ß√µes locais"
    weight: 0.9
    application_result:
      rule_outcome: "squad-level > tribe-level para guidelines"
      impact_on_decision: decisive

epistemic_rationale:
  summary: "Particionamento por escopo permite coexist√™ncia de guidelines espec√≠ficas por squad"
  reasoning: "Ambas as guidelines t√™m valor em seus contextos espec√≠ficos e n√£o apresentam conflito fundamental"
  
  references:
    moc_nodes: ["hierarchies.scope.squad-a", "hierarchies.scope.squad-b"]
    
actions:
  - "partition_scope:squad-a:uki:squad-a:guideline:code-review"
  - "partition_scope:squad-b:uki:squad-b:guideline:code-review"

audit:
  decided_at: 2025-08-26T14:35:15.456Z
  decided_by: mal-v1.0.0
  timeout_used_ms: 890
```

### Para Organiza√ß√µes

#### Configura√ß√£o de Pol√≠ticas
- Use `policy_ref` para aplicar pol√≠ticas MOC espec√≠ficas
- Configure regras de preced√™ncia organizacionais
- Adapte crit√©rios de severidade conforme contexto

#### Integra√ß√£o com Workflows
- Configure detec√ß√£o autom√°tica de conflitos
- Integre com sistemas de notifica√ß√£o
- Estabele√ßa caminhos de escala√ß√£o claros


## ‚úÖ Valida√ß√£o e Conformidade

### Eventos de Arbitragem Obrigat√≥rios
- **event_id:** Identificador √∫nico no formato mal-evt-YYYYMMDD-NNN
- **event_type:** Deve ser H1, H2 ou H3
- **candidates:** M√≠nimo 2 entidades conflitantes
- **user_moc_context:** Contexto completo do usu√°rio

### Registros de Decis√£o Imut√°veis
- **decision_id:** Identificador √∫nico no formato mal-dec-YYYYMMDD-TYPE-NNN
- **precedence_applied:** M√≠nimo 1 regra aplicada
- **epistemic_rationale:** Justificativa completa alinhada ao MEP
- **audit:** Informa√ß√µes completas de auditoria

### Regras de Preced√™ncia P1-P6
1. **P1_authority_weight:** Peso de autoridade hier√°rquica
2. **P2_scope_specificity:** Especificidade de escopo
3. **P3_maturity_level:** N√≠vel de maturidade
4. **P4_temporal_recency:** Rec√™ncia temporal
5. **P5_evidence_density:** Densidade de evid√™ncia
6. **P6_deterministic_fallback:** Fallback determin√≠stico

## üîó Integra√ß√£o com Outros Frameworks

### MEF (Matrix Embedding Framework)
- Decision Records persistidos como trilha imut√°vel
- Relacionamentos de conflito registrados entre UKIs
- Evid√™ncias MEF utilizadas na arbitragem

### MOC (Matrix Ontology Catalog)
- Pol√≠ticas de arbitragem configuradas no MOC
- Hierarquias de autoridade consultadas
- Regras de preced√™ncia organizacionais

### ZOF (Zion Orchestration Framework)
- Detec√ß√£o de conflitos no checkpoint EvaluateForEnrich
- Invoca√ß√£o autom√°tica em conflitos H1/H2/H3
- Aplica√ß√£o de a√ß√µes derivadas das decis√µes

### OIF (Operator Intelligence Framework)
- Templates de explica√ß√£o para comunicar decis√µes
- Interpreta√ß√£o de Decision Records
- Gera√ß√£o de explica√ß√µes contextualizadas

## üìñ Recursos Relacionados

### Matrix Protocol Frameworks
- **[MAL - Matrix Arbiter Layer](../../mal)** - Documenta√ß√£o completa do framework
- **[Especifica√ß√µes Can√¥nicas](../)** - Todos os schemas do protocolo
- **[Exemplos de Arbitragem](/docs/examples)** - Casos de uso pr√°ticos

### Documenta√ß√£o T√©cnica
- **[Guia de Implementa√ß√£o](/docs/implementation)** - Como implementar o protocolo
- **[Manual de Ferramentas](/docs/manual/tools)** - Ferramentas de apoio MAL
- **[Gloss√°rio](/docs/glossary)** - Defini√ß√µes e terminologia