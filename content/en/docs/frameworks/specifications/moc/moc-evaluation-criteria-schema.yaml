# MOC Evaluation Criteria Schema v1.0.0
# Matrix Ontology Catalog - Evaluation Criteria for EvaluateForEnrich
# Normative canonical specification for organizational enrichment criteria

$schema: https://json-schema.org/draft/2020-12/schema
$id: http://localhost:3000/schemas/moc/evaluation-criteria/1.0.0
version: 1.0.0
title: MOC Evaluation Criteria Schema
description: Canonical schema for EvaluateForEnrich evaluation criteria in MOC
type: object
required:
  - schema
  - organization_id
  - version
  - evaluation_profiles
  - default_profile
  - metadata
properties:
  schema:
    type: string
    description: Schema version MOC Evaluation Criteria used
    pattern: ^[0-9]+\.[0-9]+$
    examples:
      - "1.0"
      - "1.1"
  organization_id:
    type: string
    description: Unique identifier of the organization
    pattern: ^[a-z0-9-]+$
    examples:
      - techcorp
      - startup-alpha
  version:
    type: string
    description: Version of criteria configuration
    pattern: ^(0|[1-9]\d*)\.(0|[1-9]\d*)$
    examples:
      - "1.0"
      - "2.1"
  evaluation_profiles:
    type: object
    description: Criteria profiles for different organizational contexts
    minProperties: 1
    patternProperties:
      ^[a-z0-9_-]+$:
        type: object
        required:
          - display_name
          - description
          - criteria
          - applicable_contexts
        properties:
          display_name:
            type: string
            description: Display name of evaluation profile
            examples:
              - Standard Profile
              - Critical Profile
              - Experimental Profile
          description:
            type: string
            description: Description of profile and when to use
            minLength: 50
            examples:
              - Standard profile for knowledge evaluation in regular contexts
          criteria:
            type: object
            description: Profile-specific evaluation criteria
            minProperties: 1
            patternProperties:
              ^[a-z0-9_]+$:
                type: object
                required:
                  - display_name
                  - description
                  - evaluation_method
                  - threshold
                  - weight
                properties:
                  display_name:
                    type: string
                    description: Display name of criterion
                    examples:
                      - Relevance
                      - Reusability
                      - Impact
                      - Novelty
                  description:
                    type: string
                    description: Detailed description of criterion
                    minLength: 30
                    examples:
                      - Evaluates if knowledge is relevant to other team members
                  evaluation_method:
                    type: string
                    description: Criterion evaluation method
                    enum:
                      - manual
                      - automated
                      - hybrid
                      - semantic
                    examples:
                      - manual
                      - semantic
                  threshold:
                    type: object
                    description: Threshold configuration for approval
                    required:
                      - type
                      - value
                    properties:
                      type:
                        type: string
                        description: Threshold type
                        enum:
                          - binary
                          - numeric
                          - percentage
                          - categorical
                        examples:
                          - binary
                          - percentage
                      value:
                        description: Threshold value
                        oneOf:
                          - type: boolean
                          - type: number
                            minimum: 0
                            maximum: 1
                          - type: string
                            enum:
                              - low
                              - medium
                              - high
                              - critical
                        examples:
                          - true
                          - 0.7
                          - medium
                      operator:
                        type: string
                        description: Comparison operator
                        enum:
                          - ">="
                          - ">"
                          - <=
                          - <
                          - ==
                          - "!="
                        default: ">="
                        examples:
                          - ">="
                          - ">"
                    additionalProperties: false
                  weight:
                    type: number
                    description: Relative weight of criterion (0.0 to 1.0)
                    minimum: 0
                    maximum: 1
                    examples:
                      - 0.25
                      - 0.35
                      - 0.4
                  scoring_algorithm:
                    type: string
                    description: Specific scoring algorithm
                    enum:
                      - boolean
                      - linear
                      - logarithmic
                      - exponential
                      - custom
                    default: boolean
                    examples:
                      - linear
                      - boolean
                  custom_evaluator:
                    type: string
                    description: Custom evaluation function
                    examples:
                      - semantic_similarity
                      - business_value_calculator
                  failure_action:
                    type: string
                    description: Action when criterion fails
                    enum:
                      - block
                      - warn
                      - defer
                      - escalate
                    default: block
                    examples:
                      - block
                      - escalate
                  dependencies:
                    type: array
                    description: Criteria that must pass first
                    items:
                      type: string
                      pattern: ^[a-z0-9_]+$
                    examples:
                      - - relevance
                        - authority
                  exemptions:
                    type: array
                    description: Contexts where criterion can be ignored
                    items:
                      type: object
                      required:
                        - condition
                        - reason
                      properties:
                        condition:
                          type: string
                          description: Condition for exemption
                          examples:
                            - maturity_ref == 'experimental'
                        reason:
                          type: string
                          description: Rationale for exemption
                        authority_required:
                          type: string
                          description: Authority required for exemption
                      additionalProperties: false
                additionalProperties: false
            additionalProperties: false
          applicable_contexts:
            type: object
            description: Contexts where this profile applies
            properties:
              scopes:
                type: array
                description: Applicable organizational scopes
                items:
                  type: string
                  pattern: ^[a-z0-9-]+$
                examples:
                  - - squad
                    - tribe
                    - organization
              domains:
                type: array
                description: Applicable knowledge domains
                items:
                  type: string
                  pattern: ^[a-z0-9-]+$
                examples:
                  - - technical
                    - business
                    - security
              maturity_levels:
                type: array
                description: Applicable maturity levels
                items:
                  type: string
                  pattern: ^[a-z0-9_]+$
                examples:
                  - - draft
                    - experimental
                    - validated
              knowledge_types:
                type: array
                description: Applicable knowledge types
                items:
                  type: string
                  pattern: ^[a-z0-9_]+$
                examples:
                  - - pattern
                    - guideline
                    - policy
              user_roles:
                type: array
                description: User roles that use this profile
                items:
                  type: string
                examples:
                  - - developer
                    - tech_lead
                    - architect
            additionalProperties: false
          execution_config:
            type: object
            description: Evaluation execution configurations
            properties:
              timeout_ms:
                type: integer
                description: Timeout for evaluation execution
                minimum: 100
                maximum: 60000
                default: 5000
                examples:
                  - 5000
                  - 10000
              parallel_execution:
                type: boolean
                description: Allows parallel execution of criteria
                default: true
              fail_fast:
                type: boolean
                description: Stop at first criterion failure
                default: false
              require_all_pass:
                type: boolean
                description: Requires all criteria to pass
                default: true
              weighted_scoring:
                type: boolean
                description: Uses weighted scoring instead of all-or-nothing
                default: false
              minimum_score:
                type: number
                description: Minimum score for approval (if weighted_scoring=true)
                minimum: 0
                maximum: 1
                examples:
                  - 0.7
                  - 0.8
            additionalProperties: false
        additionalProperties: false
    additionalProperties: false
  default_profile:
    type: string
    description: ID of default evaluation profile
    pattern: ^[a-z0-9_-]+$
    examples:
      - standard
      - default
      - minimal
  context_mapping:
    type: object
    description: Mapping of contexts to specific profiles
    properties:
      scope_overrides:
        type: object
        description: Specific profiles by scope
        patternProperties:
          ^[a-z0-9-]+$:
            type: string
            pattern: ^[a-z0-9_-]+$
        examples:
          organization: critical
          squad: standard
      domain_overrides:
        type: object
        description: Specific profiles by domain
        patternProperties:
          ^[a-z0-9-]+$:
            type: string
            pattern: ^[a-z0-9_-]+$
        examples:
          security: critical
          experimental: minimal
      maturity_overrides:
        type: object
        description: Specific profiles by maturity level
        patternProperties:
          ^[a-z0-9_]+$:
            type: string
            pattern: ^[a-z0-9_-]+$
        examples:
          validated: critical
          draft: minimal
    additionalProperties: false
  metadata:
    type: object
    description: Metadata of criteria configuration
    required:
      - created_date
      - last_modified
      - maintainer
    properties:
      created_date:
        type: string
        format: date
        description: Creation date of configuration
      last_modified:
        type: string
        format: date
        description: Last modification date
      maintainer:
        type: string
        description: Responsible for criteria maintenance
        examples:
          - governance-team
          - platform-team
      change_summary:
        type: string
        description: Summary of changes in current version
      validation_status:
        type: string
        description: Configuration validation status
        enum:
          - valid
          - pending
          - invalid
      testing_results:
        type: object
        description: Criteria testing results
        properties:
          last_test_date:
            type: string
            format: date
          test_coverage:
            type: number
            minimum: 0
            maximum: 1
          success_rate:
            type: number
            minimum: 0
            maximum: 1
        additionalProperties: false
    additionalProperties: false
additionalProperties: false
allOf:
  - properties:
      default_profile:
        description: Must exist in evaluation_profiles
  - properties:
      evaluation_profiles:
        patternProperties:
          ^[a-z0-9_-]+$:
            properties:
              criteria:
                description: Sum of weights must be <= 1.0
