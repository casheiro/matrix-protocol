# MOC Hierarchy Schema v1.0.0
# Matrix Ontology Catalog - Organizational Hierarchies
# Normative canonical specification for definition of configurable hierarchies

$schema: https://json-schema.org/draft/2020-12/schema
$id: http://localhost:3000/schemas/moc/hierarchy/1.0.0
version: 1.0.0
title: MOC Hierarchy Schema
description: Canonical schema for configurable organizational hierarchies in MOC
type: object
required:
  - schema
  - organization_id
  - version
  - hierarchies
  - metadata
properties:
  schema:
    type: string
    description: Schema version MOC Hierarchy used
    pattern: ^[0-9]+\.[0-9]+$
    examples:
      - "1.0"
      - "1.1"
  organization_id:
    type: string
    description: Unique identifier of the organization
    pattern: ^[a-z0-9-]+$
    examples:
      - techcorp
      - startup-alpha
      - enterprise-beta
  version:
    type: string
    description: Version of organizational MOC configuration
    pattern: ^(0|[1-9]\d*)\.(0|[1-9]\d*)$
    examples:
      - "1.0"
      - "2.1"
      - "3.0"
  hierarchies:
    type: object
    description: Mandatory configurable hierarchies
    required:
      - scope
      - domain
      - maturity
      - evaluation_criteria
    properties:
      scope:
        type: object
        description: Hierarchy of knowledge scope and visibility
        required:
          - description
          - nodes
        properties:
          description:
            type: string
            description: Description of organizational scope hierarchy
            examples:
              - Organizational structure of teams and tribes
          nodes:
            type: object
            description: Scope hierarchy nodes
            patternProperties:
              ^[a-z0-9-]+$:
                type: object
                required:
                  - display_name
                  - level
                  - parent
                properties:
                  display_name:
                    type: string
                    description: Display name of the node
                    examples:
                      - Squad Payments
                      - Tribe Platform
                  level:
                    type: integer
                    description: Hierarchical level (lower = more specific)
                    minimum: 0
                    maximum: 10
                    examples:
                      - 0
                      - 1
                      - 2
                  parent:
                    type:
                      - string
                      - "null"
                    description: Parent node in hierarchy (null for root)
                    pattern: ^[a-z0-9-]+$|null
                    examples:
                      - tribe-platform
                      - null
                  description:
                    type: string
                    description: Scope description
                    examples:
                      - Team responsible for payment functionalities
                  authority_roles:
                    type: array
                    description: Roles with authority in this scope
                    items:
                      type: string
                    examples:
                      - - squad_lead
                        - tech_lead
                        - developer
                additionalProperties: false
            additionalProperties: false
        additionalProperties: false
      domain:
        type: object
        description: Hierarchy of knowledge areas and specialization
        required:
          - description
          - nodes
        properties:
          description:
            type: string
            description: Description of domain hierarchy
            examples:
              - Technical and business knowledge domains
          nodes:
            type: object
            description: Domain hierarchy nodes
            patternProperties:
              ^[a-z0-9-]+$:
                type: object
                required:
                  - display_name
                  - scope
                  - specializations
                properties:
                  display_name:
                    type: string
                    description: Display name of the domain
                    examples:
                      - Technical
                      - Business
                      - Security
                  scope:
                    type: string
                    description: Domain application scope
                    enum:
                      - global
                      - contextual
                      - specialized
                    examples:
                      - global
                      - contextual
                  description:
                    type: string
                    description: Domain description
                    examples:
                      - Technical implementation knowledge
                  specializations:
                    type: array
                    description: Specializations within the domain
                    items:
                      type: string
                    examples:
                      - - frontend
                        - backend
                        - devops
                  access_control:
                    type: object
                    description: Domain access controls
                    properties:
                      restricted_scopes:
                        type: array
                        description: Scopes with restricted access
                        items:
                          type: string
                      required_authority:
                        type: string
                        description: Minimum authority for access
                        examples:
                          - developer
                          - specialist
                    additionalProperties: false
                additionalProperties: false
            additionalProperties: false
        additionalProperties: false
      maturity:
        type: object
        description: Hierarchy of validation levels and reliability
        required:
          - description
          - nodes
        properties:
          description:
            type: string
            description: Description of maturity hierarchy
            examples:
              - Epistemological maturity levels of knowledge
          nodes:
            type: object
            description: Maturity hierarchy nodes
            patternProperties:
              ^[a-z0-9_]+$:
                type: object
                required:
                  - display_name
                  - rank
                  - criteria
                  - transitions
                properties:
                  display_name:
                    type: string
                    description: Display name of maturity level
                    examples:
                      - Draft
                      - Experimental
                      - Endorsed
                      - Validated
                  rank:
                    type: integer
                    description: Numeric rank (higher = more mature)
                    minimum: 0
                    maximum: 100
                    examples:
                      - 10
                      - 30
                      - 60
                      - 90
                  description:
                    type: string
                    description: Description of maturity level
                    examples:
                      - Knowledge in initial development
                  criteria:
                    type: array
                    description: Criteria to reach this level
                    items:
                      type: string
                    examples:
                      - - Peer review
                        - Validated tests
                  transitions:
                    type: object
                    description: Possible transitions to other levels
                    properties:
                      can_promote_to:
                        type: array
                        description: Levels to which it can be promoted
                        items:
                          type: string
                        examples:
                          - - endorsed
                            - validated
                      can_demote_to:
                        type: array
                        description: Levels to which it can be demoted
                        items:
                          type: string
                        examples:
                          - - draft
                            - deprecated
                    additionalProperties: false
                  authority_required:
                    type: string
                    description: Minimum authority to create knowledge at this level
                    examples:
                      - developer
                      - tech_lead
                      - architect
                additionalProperties: false
            additionalProperties: false
        additionalProperties: false
      evaluation_criteria:
        type: object
        description: Criteria for ZOF EvaluateForEnrich checkpoint
        required:
          - description
          - nodes
        properties:
          description:
            type: string
            description: Description of evaluation criteria
            examples:
              - Organizational criteria for Oracle enrichment
          nodes:
            type: object
            description: Configurable evaluation criteria
            patternProperties:
              ^[a-z0-9_]+$:
                type: object
                required:
                  - display_name
                  - description
                  - threshold_type
                  - weight
                properties:
                  display_name:
                    type: string
                    description: Display name of criterion
                    examples:
                      - Relevance
                      - Reusability
                      - Impact
                  description:
                    type: string
                    description: Detailed description of criterion
                    examples:
                      - Knowledge relevance to other team members
                  threshold_type:
                    type: string
                    description: Type of approval threshold
                    enum:
                      - binary
                      - low
                      - medium
                      - high
                      - numeric
                    examples:
                      - medium
                      - high
                  threshold_value:
                    type:
                      - number
                      - boolean
                      - string
                    description: Specific threshold value
                    examples:
                      - 0.7
                      - true
                      - high
                  weight:
                    type: number
                    description: Relative weight of criterion (0.0 to 1.0)
                    minimum: 0
                    maximum: 1
                    examples:
                      - 0.3
                      - 0.4
                      - 0.3
                  evaluation_method:
                    type: string
                    description: Criterion evaluation method
                    enum:
                      - manual
                      - automated
                      - hybrid
                    examples:
                      - manual
                      - automated
                  applicable_domains:
                    type: array
                    description: Domains where this criterion applies
                    items:
                      type: string
                    examples:
                      - - technical
                        - business
                  applicable_scopes:
                    type: array
                    description: Scopes where this criterion applies
                    items:
                      type: string
                    examples:
                      - - squad
                        - tribe
                additionalProperties: false
            additionalProperties: false
        additionalProperties: false
    additionalProperties: false
  optional_hierarchies:
    type: object
    description: Optional specific organizational hierarchies
    properties:
      authority:
        type: object
        description: Organizational authority hierarchy
        properties:
          description:
            type: string
          nodes:
            type: object
            patternProperties:
              ^[a-z0-9_]+$:
                type: object
                properties:
                  display_name:
                    type: string
                  level:
                    type: integer
                  permissions:
                    type: array
                    items:
                      type: string
                  reports_to:
                    type:
                      - string
                      - "null"
                additionalProperties: false
            additionalProperties: false
        additionalProperties: false
      lifecycle:
        type: object
        description: Knowledge lifecycle hierarchy
        properties:
          description:
            type: string
          nodes:
            type: object
            patternProperties:
              ^[a-z0-9_]+$:
                type: object
                properties:
                  display_name:
                    type: string
                  duration:
                    type: string
                  actions:
                    type: array
                    items:
                      type: string
                  triggers:
                    type: array
                    items:
                      type: string
                additionalProperties: false
            additionalProperties: false
        additionalProperties: false
    additionalProperties: true
  metadata:
    type: object
    description: MOC configuration metadata
    required:
      - created_date
      - last_modified
      - maintainer
    properties:
      created_date:
        type: string
        format: date
        description: Creation date of configuration
        examples:
          - 2025-01-15
      last_modified:
        type: string
        format: date
        description: Last modification date
        examples:
          - 2025-10-31
      maintainer:
        type: string
        description: Responsible for MOC maintenance
        examples:
          - platform-team
          - governance-board
      change_summary:
        type: string
        description: Summary of changes in current version
        examples:
          - Addition of impact criterion for evaluation
      validation_status:
        type: string
        description: Configuration validation status
        enum:
          - valid
          - pending
          - invalid
        examples:
          - valid
      compliance_tags:
        type: array
        description: Regulatory compliance tags
        items:
          type: string
        examples:
          - - lgpd
            - iso27001
            - sox
    additionalProperties: false
additionalProperties: false
allOf:
  - properties:
      hierarchies:
        properties:
          scope:
            properties:
              nodes:
                patternProperties:
                  ^[a-z0-9-]+$:
                    if:
                      properties:
                        parent:
                          not:
                            const: null
                    then: false
  - properties:
      hierarchies:
        properties:
          evaluation_criteria:
            properties:
              nodes:
                allOf: []
