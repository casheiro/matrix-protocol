---
title: Uki Pay Currency Rates 004
description: P√°gina wrapper para o asset YAML uki-pay-currency-rates-004.yaml
icon: i-heroicons-code-bracket
layout: docs
sidebar: true
toc: true
navigation: true
lang: pt
last_updated: 2025-10-21T00:00:00.000Z
order: 10
framework: general
tags:
  - examples
  - structured
  - business-rules
keywords:
  - Matrix Protocol
  - MEF
  - UKI
  - convers√£o de moeda
  - taxas de c√¢mbio
  - cota√ß√£o de moedas
  - fallback de APIs
  - margem de seguran√ßa
  - cache de cota√ß√£o
  - squad payments
---
> Source YAML: `pt/docs/examples/knowledge/structured/business-rules/uki-pay-currency-rates-004.yaml`

**Abrir no Visualizador:** [Uki Pay Currency Rates 004](/pt/docs/viewer?file=/docs/examples/knowledge/structured/business-rules/uki-pay-currency-rates-004.yaml)

> üìÑ Tipo: YAML ‚Ä¢ üì¶ Tamanho: 3.0 KB ‚Ä¢ üïí √öltima modifica√ß√£o: 2025-10-10



```yaml

schema: "1.0"
ontology_reference: "moc:squad-payments:v1.0"
version: "1.5.0"

id: uki:squad-payments:business_rule:currency-conversion-004
title: "Regras de Convers√£o de Moeda e Cota√ß√£o"
scope_ref: squad-payments
scope_mode: "propagated"
domain_ref: business
type_ref: business_rule
maturity_ref: draft

created_date: 2024-03-25
last_modified: 2024-03-25
change_summary: "Defini√ß√£o de fallback e toler√¢ncias para API de cota√ß√£o inst√°vel"
change_impact: minor
status: active

content: |
  ## Moedas Suportadas
  
  **Prim√°ria:** BRL (Real Brasileiro)
  **Secund√°rias aceitas:**
  - USD (D√≥lar Americano)  
  - EUR (Euro)
  - GBP (Libra Esterlina)
  
  ## Fonte de Cota√ß√£o
  
  **Prim√°ria:** exchangerate-api.io (API comercial)
  **Backup:** Cota√ß√£o fixa atualizada semanalmente
  **Frequ√™ncia atualiza√ß√£o:** A cada 1 hora durante hor√°rio comercial
  
  ## Regras de Fallback
  
  **API indispon√≠vel ou timeout:**
  - EUR ‚Üí BRL: 6.20 (cota√ß√£o conservadora)
  - USD ‚Üí BRL: 5.10 (cota√ß√£o conservadora)  
  - GBP ‚Üí BRL: 6.80 (cota√ß√£o conservadora)
  
  **Varia√ß√£o suspeita (> 5% em 1 hora):**
  - Usar cota√ß√£o anterior at√© valida√ß√£o manual
  - Alert autom√°tico para equipe financeira
  - Log detalhado da varia√ß√£o para auditoria
  
  ## Cache e Performance
  
  **TTL do cache:** 60 minutos
  **Chave Redis:** "currency_rate_{from}_{to}_{date}"
  **Invalida√ß√£o:** Manual via endpoint admin ou autom√°tica por timeout
  
  ## Toler√¢ncias e Margens
  
  **Margem de seguran√ßa:** 2% sobre cota√ß√£o obtida
  **Justificativa:** Cobertura de flutua√ß√£o durante processamento
  **Arredondamento:** Sempre para cima, 2 casas decimais
  
  ## Valida√ß√µes Obrigat√≥rias
  
  - Cota√ß√£o n√£o pode ser zero ou negativa
  - Varia√ß√£o m√°xima 10% da cota√ß√£o anterior (bloqueio autom√°tico)
  - Data da cota√ß√£o n√£o pode ser > 24h antiga
  - Log de todas convers√µes para auditoria financeira

examples:
  - input: "Compra ‚Ç¨100, cota√ß√£o API 6.15, margem 2%"
    output: "Cobran√ßa: R$ 628.30 (‚Ç¨100 √ó 6.15 √ó 1.02)"
  - input: "API timeout, compra ‚Ç¨50, cota√ß√£o fallback"
    output: "Cobran√ßa: R$ 316.00 (‚Ç¨50 √ó 6.20, fallback + log alert)"
  - input: "Cota√ß√£o suspeita: EUR 8.50 (anterior 6.15)"
    output: "Bloqueio: varia√ß√£o 38% > threshold 10%, usar cota√ß√£o anterior"

relationships:
  - type: implements
    target: uki:squad-payments:procedure:monitoring-alerts-016
    description: "Padr√£o de integra√ß√£o com API externa para cota√ß√£o"
    
  - type: depends_on
    target: uki:squad-payments:technical_pattern:gateway-integration-007
    description: "Estrat√©gia de cache Redis para performance"
    
  - type: relates_to
    target: uki:squad-payments:procedure:monitoring-alerts-016
    description: "Alerts de cota√ß√£o suspeita integrados ao monitoramento"

promotion:
  promotion_rationale: |
    Regras de convers√£o podem beneficiar outras squads (marketplace, subscriptions).
    Demonstrou estabilidade e foi validada em ambiente de produ√ß√£o.

domain_of_influence: "engineering_teams"
```
