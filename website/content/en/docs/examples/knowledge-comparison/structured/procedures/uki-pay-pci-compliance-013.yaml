schema: "1.0"
ontology_reference: "moc:squad-payments:v1.0"
id: uki:squad-payments:procedure:pci-compliance-013
title: "PCI DSS Compliance Procedure"
version: 2.0.0
created_date: 2024-03-25
last_modified: 2024-03-25
change_summary: "Update based on 2024 audit and compliance officer checklist"
change_impact: major
previous_version: 1.5.0

scope_ref: squad-payments
scope_mode: "restricted"
domain_ref: technical
type_ref: procedure
maturity_ref: validated
status: active

content: |
  ## Critical Requirements (SAQ-A-EP Level)
  
  ### 1. Data Encryption
  **In transit:**
  - TLS 1.3 mandatory (minimum TLS 1.2)
  - Certificate pinning for critical APIs
  - Strict certificate verification
  
  **At rest:**
  - AES-256 for sensitive data
  - Tokenization preferred over encryption
  - Database-level encryption for cardholder data
  
  ### 2. Access Control
  **Authentication:**
  - Multi-factor authentication for admin access
  - Strong password policy (12+ chars, complexity)
  - Account lockout after 5 failed attempts
  - Session timeout: 15 minutes idle
  
  **Authorization:**
  - Role-based access control (RBAC)
  - Principle of least privilege
  - Regular access review (quarterly)
  - Segregation of duties for critical operations
  
  ### 3. Cardholder Data Handling
  **Prohibited actions:**
  - Never store CVV/CVC codes
  - Never store full magnetic stripe data
  - Never store PIN verification values
  
  **Permitted storage (encrypted):**
  - Primary Account Number (PAN) - tokenized only
  - Cardholder name
  - Expiration date
  - Service code (if necessary)
  
  ### 4. Network Security
  **Firewall configuration:**
  - Default deny policy
  - Whitelist approach for allowed traffic
  - Regular rule review and cleanup
  - DMZ for cardholder data environment
  
  **Network segmentation:**
  - Separate network for payment processing
  - VLANs for sensitive systems
  - Regular penetration testing
  - Network monitoring and logging
  
  ### 5. System Monitoring
  **Logging requirements:**
  - All payment transactions logged
  - Access attempts (successful and failed)
  - Administrative actions
  - System changes and configurations
  
  **Log protection:**
  - Tamper-evident logging
  - Centralized log management
  - Real-time monitoring for suspicious activity
  - Log retention: minimum 1 year
  
  ## Implementation Checklist
  
  ### Monthly Tasks
  - [ ] Review user access permissions
  - [ ] Update antivirus definitions
  - [ ] Check system patches and updates
  - [ ] Review firewall logs for anomalies
  - [ ] Test backup and recovery procedures
  
  ### Quarterly Tasks
  - [ ] Conduct vulnerability scans
  - [ ] Review and update security policies
  - [ ] Test incident response procedures
  - [ ] Update risk assessment
  - [ ] Review third-party security assessments
  
  ### Annual Tasks
  - [ ] PCI DSS compliance assessment
  - [ ] Penetration testing by qualified assessor
  - [ ] Security awareness training for all staff
  - [ ] Review and update incident response plan
  - [ ] Validate compensation controls
  
  ## Incident Response
  
  ### Data Breach Response
  1. **Immediate containment** (within 1 hour)
     - Isolate affected systems
     - Stop data exfiltration
     - Preserve evidence
  
  2. **Assessment** (within 24 hours)
     - Determine scope of breach
     - Identify compromised data
     - Assess business impact
  
  3. **Notification** (within 72 hours)
     - Payment brands (Visa, Mastercard, etc.)
     - Acquiring bank
     - Law enforcement (if required)
     - Affected customers
  
  4. **Recovery and lessons learned**
     - Implement corrective actions
     - Update security controls
     - Document lessons learned
     - Update incident response plan
  
  ## Key Contacts
  
  **Internal:**
  - Security Officer: security@company.com
  - Compliance Team: compliance@company.com
  - IT Operations: itops@company.com
  - Legal Department: legal@company.com
  
  **External:**
  - QSA (Qualified Security Assessor): [Contact details]
  - Acquiring Bank: [Contact details]
  - Payment Processor: [Contact details]
  - Forensic Investigator: [Contact details]

examples:
  - input: "Suspicious login attempt detected from unknown IP"
    output: "Block IP immediately, review logs, assess if cardholder data accessed, notify security team within 1 hour"
  - input: "Developer requests access to production payment database"
    output: "Deny by default, require business justification, implement time-limited access with monitoring"
  - input: "Third-party vendor requests cardholder data for analysis"
    output: "Verify vendor PCI compliance, require signed agreement, provide tokenized data only"

relationships:
  - type: implements
    target: uki:squad-payments:business_rule:fraud-thresholds-003
    description: "Fraud detection supports PCI compliance monitoring"
    
  - type: relates_to
    target: uki:squad-payments:technical_pattern:security-headers-010
    description: "Security headers complement PCI compliance requirements"
    
  - type: relates_to
    target: uki:squad-payments:procedure:incident-response-014
    description: "General incident response extends to PCI-specific incidents"

domain_of_influence: "engineering_teams"